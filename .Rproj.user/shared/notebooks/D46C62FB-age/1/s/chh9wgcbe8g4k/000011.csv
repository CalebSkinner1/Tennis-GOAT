"0","#| tbl-cap: Best Player by Year of Birth
players %>%
  group_by(name, dob, ioc) %>%
  # group_by(name) %>%
  summarize(
    `Total Points` = sum(points) + sum(bonus),
    `Victory Points` = sum(points),
    `Bonus Points` = sum(bonus),
    Victories = sum(points > 0),
    Defeats = sum(points < 0),
    `Win Percent` = scales::percent(Victories/(Victories + Defeats), accuracy = .01)) %>%
  ungroup() %>%
  rename(
    Country = ioc,
    Name = name) %>%
  arrange(desc(`Total Points`)) %>%
  mutate(
    Rank = row_number(),
    `Birth Year` = year(dob)) %>%
  relocate(Rank, .before = Name) %>%
  relocate(`Birth Year`, .before = Country) %>%
  select(-dob) %>%
  group_by(`Birth Year`) %>%
  mutate(rank_year = row_number()) %>%
  filter(rank_year == 1) %>%
  arrange(`Birth Year`) %>%
  filter(`Birth Year` > 1933) %>%
  select(-rank_year) %>%
  flextable() %>%
  align(align = ""center"", part = ""all"") %>%
  width(j = 10, width = 1.3) %>%
  width(j = 2, width = 2.2) %>%
  width(j = 4, width = 1.6) %>%
  width(j = c(1,8:9), width = .7) %>%
  colformat_double(j = c(5,7,8,9), digits = 0) %>%
  colformat_double(j = 3,
    big.mark = """", digits = 0, na_str = ""N/A"")
"
"1","[38;5;250m`summarise()` has grouped output by 'name', 'dob'. You can override using the `.groups` argument.[39m
"
